{% extends "base.html" %}
{% load staticfiles %}
{% block content %}

{% if valide != '' %}
<br />
<center><strong>{{ valide }}</strong></center>
{% endif %}


	{% if user.typeUser == 'Professionnel' and user.username == nameProfessionnel %}
		<div>
			<form action="/project/{{ projet.key }}/contract" style="margin: 0px;">
				<button class="edit_contract">Editer contrat</button>
			</form>
		</div>
	{% endif %}
	
{% if projet and user.is_authenticated %}
	{% if user.typeUser == 'Professionnel' and user.username == nameProfessionnel and namePrestataire == '' %}
		<div class="add_prestataire">
			<form method="post">
				{% csrf_token %}
				<button class="prestataire_button">+</button>
				<input style="padding-top: 13px; padding-bottom: 13px; margin-top: 5px; width: 53%" type="email" name="email" placeholder="Entrez l'email du Prestataire à ajouter au projet">
			</form>
		</div>
	{% endif %}

	<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    	<div class="upload">
	    	<label for="lol" title="Choisissez un document à upload" style="cursor:pointer;margin-right: 3px;">Parcourir</label>
		    <input type="file" name="document" id="lol" style="display:none" required>
		    {% if user.typeUser == 'Client' %}
		    <select id="monselect" name="typeName" title="Définissez de quel type de document il s'agit" required>
				<option value="documents_contrat">Documents nécessaires au contrat</option> 
				<option value="photos" selected>Photos</option>
			</select>
		    {% elif user.typeUser == 'Prestataire' %}
		    <select id="monselect" name="typeName" title="Définissez de quel type de document il s'agit" required>
				<option value="devis">Devis</option> 
				<option value="facture" selected>Facture</option>
				<option value="photos">Photos</option> 
				<option value="avancee_pre" selected>Avancée du projet</option>
			</select>
		    {% elif user.typeUser == 'Professionnel'%}
		    <select id="monselect" name="typeName" title="Définissez de quel type de document il s'agit" required>
				<option value="demande_travaux">Demande de travaux</option> 
				<option value="contrat" selected>Contrat du projet</option>
				<option value="photos" selected>Photos</option>
				<option value="avancee_pro" selected>Avancée du projet</option>
			</select>
		    {% endif %}
		</div>
	    <button class="upload_document">Upload un document</button>
	    
	</form>


	<table>
	</table>
	<table>
		<tr>
		 <th></th>
		 <th>Infos projet</th>
		</tr>
		<tr>
		 <th>Nom</th>
		 <td>{{ projet.titre }}</td>
		</tr>
		<tr>
		 <th>Client</th>
		 <td>{{ nameClient }}</td>
		</tr>
		<tr>
		 <th>Professionnel</th>
		 <td>{{ nameProfessionnel }}</td>
		</tr>
		<tr>
		 <th>Prestataire</th>
		 <td>{{ namePrestataire }}</td>
		</tr>
		<tr>
		 <th>Date début</th>
		 <td>{{ projet.date_debut }}</td>
		</tr>
		<tr>
		 <th>Date fin</th>
		 <td>{{ projet.date_fin }}</td>
		</tr>
		<tr>
		 <th>Description</th>
		 <td>{{ projet.description }}</td>
		</tr>
	</table>

	
		<table>
			<tr>
		     <th>Nom du document</th>
		     <th>Type de document</th>
		     <th>Uploadé par</th>
		     <th>Date d'upload</th>
		    </tr>
			<tr>
			{% for file in files %}
		     	<td>{{ file.original_name }}</td>
		     	<td>{{ file.typeName }}</td>
		     	<td>{{ file.uploaded_by }}</td>
		     	<td>{{ file.upload_date }}</td>
		     	<form method='post' action=/download/{{ projet.key }}/{{ file.key }}>
		     		{% csrf_token %}
		     		<td><input type="submit" title="Télécharger" name="download" value="  " style="background-image:url({% static 'img/download.jpg' %});cursor:pointer;"/></td>
		     	</form>
		    </tr>
			{% endfor %}
		</table>
	

{% endif %}




{% endblock %}